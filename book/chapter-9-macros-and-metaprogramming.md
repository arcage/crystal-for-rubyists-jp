# 第9章: マクロとメタプログラミング

我々は、動的な性質とメタプログラミングがあるので、Ruby を愛しているといってもいいでしょう。Ruby と異なり、Crystal はコンパイル型言語です。これにより、いくつかの重要な違いがあります。

* `eval` がないこと
* `send` がないこと

Crystal では `マクロ` をつかって、eval や send のようなふるまいやメタプログラミングを実現します。`マクロ` は「コードを書きかえる・更新するコードである」と考えてください。

マクロはコンパイル時に、コードに展開されます。

この様子を見てみましょう。

```ruby
macro define_method(name, content)
  def {{name}}
    {{content}}
  end
end

define_method foo, 1
# This generates:
#
#     def foo
#       1
#     end

foo # => 1
```

この例では、`define_method` という名前のマクロを作成し、これを普通の関数のように呼びました。このマクロは以下のように展開されます。

```ruby
  def foo
    1
  end
```

これで、コンパイル時に `eval` のようにふるまうものを手に入れました。

マクロはとてもパワフルですが、「**マクロは適切なCrystalプログラムに展開される**」という厳しいルールが存在します。
